<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>race - Leaderboard </title>
    <link href="https://fonts.googleapis.com/css?family=Passion+One" rel="stylesheet">
    <style type="text/css">

    </style>
</head>
<body>
  <div id="scoreboard">
         <div class="flexbox">
                     <div class="row header">
                           <div class="column">#</div>
                             <div class="column">Name</div>
                             <div class="column">Place</div>
                             <div class="column">Time</div>
                           </div>
                         <div class="players"></div>
                       </div>
                   </div>
    <script>
              $scoreboard = $('#scoreboard'),
              $players_el = $('#scoreboard .players'),

              jcmp.AddEvent('Player_data_Leaderboard', function(playername,leaderboardplace,time) {

                  });
              function addPlayer(player) {
                                      if (typeof findPlayer(player.id) !== 'undefined') {
                                          return false;
                                      }

                                      var $el = $('<div class="row" style="color:' + player.colour + ';"> \
                                          <div class="column" data-element="networkId">' + player.id + '</div> \
                                          <div class="column" data-element="name">' + player.name + '</div> \
                                          <div class="column" data-element="place">' + leaderboardplace + '</div> \
                                          <div class="column" data-element="time">' + time + '</div> \
                                      </div>');



                                      player.isLocalPlayer ? $el.prependTo($players_el) : $el.appendTo($players_el);
                                      player.element = $el;
                                      $players.push(player);
                                      return true;
                                  }

                                  function destroyPlayer(networkId) {
                                      var player = findPlayer(networkId);
                                      if (typeof player === 'undefined') {
                                          return false;
                                      }

                                      player.element.remove();
                                      $players.splice($players.indexOf(player), 1);
                                      return true;
                                  }

                                  function updatePlayer(networkId, kills, deaths) {
                                      var player = findPlayer(networkId);
                                      if (typeof player === 'undefined') {
                                          return false;
                                      }

                                      player.kills = kills;
                                      player.deaths = deaths;
                                      player.element.find('[data-element="place"]').text(player.race.place); // to replace
                                      player.element.find('[data-element="time"]').text(player.race.time);  // to replace
                                  }

                                  function findPlayer(networkId) {
                                      var result = $.grep($players, function(obj) {
                                          return obj.id == networkId;
                                      });

                                      if (result.length === 0) {
                                          return undefined;
                                      }

                                      return result[0];
                                  }

                                  function formatPlayerName(name, colour) {
                                      var format;

                                      if (typeof name !== 'undefined') {
                                          format = $('<span />', {
                                              text: name
                                              style: 'color: ' + colour
                                          });

                                          if (name.length > 20) {
                                              format.addClass('small');
                                          }
                                      }

                                      return format;
                                  }

                                  jcmp.AddEvent('race_scoreboard_addplayer', function(data) {

                  addPlayer($.parseJSON(data));
              });

              jcmp.AddEvent('race_scoreboard_updateplayer', function(networkId, place, times) {
                  updatePlayer(networkId, place, times);
              });

              jcmp.AddEvent('race_scoreboard_removeplayer', function(networkId) {
                  destroyPlayer(networkId);
              });

    </script>
</body>
</html>
